{"version":3,"sources":["../webpack/bootstrap","../../../node_modules/cube-core/built/index.js","../../../node_modules/cube-core/built/utils/aggregation.js","../../../node_modules/cube-core/built/core/index.js","../../../node_modules/cube-core/built/core/periodCube.js","../../../node_modules/cube-core/built/core/momentCube.js","../../../node_modules/cube-core/built/utils/transform.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../../visual-insights/build/esm/utils.js","../../visual-insights/build/esm/distribution.js","../../visual-insights/build/esm/impurityMeasure.js","../../visual-insights/build/esm/univariateSummary/index.js","workers/fieldsSummary.worker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","this","__assign","index_1","transform_1","aggregation_1","operatorMap","sum_unsafe","mean","count","createCube","_a","type","_b","aggFunc","_c","factTable","_d","dimensions","_e","measures","periodCube","momentCube","default","props","asFields","operator","dataSource","cube","table","tree2Table","forEach","row","as","__export","subset","sums","mea","_loop_1","len","length","sum","_loop_2","Number","MEASURES","cnts","_loop_3","periodCube_1","momentCube_1","__read","iterator","e","ar","next","done","push","error","__spread","arguments","concat","__values","TypeError","Node","children","Map","_rawData","cache","params","_i","apply","aggData","_aggData","rawData","clearCache","e_1","size","values","children_1","children_1_1","child","data","e_1_1","return","configurable","getNode","search","node","level","e_2","entries","children_2","children_2_1","childName","e_2_1","tree","e_3","children_3","children_3_1","e_3_1","buildTree","insertNode","record","member","has","set","aggTree","e_4","children_4","children_4_1","e_4_1","aggNode","e_5","children_5","children_5_1","e_5_1","setData","assign","dfs","_defineProperty","obj","writable","_toConsumableArray","arr","Array","isArray","arr2","iter","toString","from","ownKeys","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","target","source","getOwnPropertyDescriptors","defineProperties","MAGIC_NUMBER","deepcopy","JSON","parse","stringify","isFieldCategory","fieldName","every","isFieldContinous","isFieldTime","isNaN","Date","test","memberCount","field","counter","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","undefined","_step4","_iterator4","err","groupContinousField","_ref5","_ref5$newField","newField","groupNumber","map","item","max","Math","min","segWidth","ranges","left","right","Infinity","precision","log10","abs","_loop2","_i2","rangeIndex","findIndex","range","toPrecision","groupCategoryField","_ref6","_ref6$newField","members","sort","a","b","v","_i3","Set","_i4","add","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","isUniformDistribution","normalize","frequencyList","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","f","entropy","probabilityList","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","log2","MIN_QUAN_MEMBER_SIZE","getFieldType","getAllFieldTypes","fields","fieldsWithType","getFieldDistribution","memberName","getAllFieldsDistribution","fieldsDistribution","distribution","getFieldEntropy","maxEntropy","getAllFieldsEntropy","fieldEntropyList","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","groupFields","groupedData","newFields","newFieldName","self","addEventListener","fieldNames","fieldDistributionList","fieldTypeList","postMessage","success","index","message"],"mappings":"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","file":"7d747101bb00d56acb10.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Rath/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __export(m) {\n  for (var p in m) {\n    if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n  }\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar index_1 = require(\"./core/index\"); // import { JsonRecord } from './types';\n\n\nvar transform_1 = require(\"./utils/transform\");\n\nvar aggregation_1 = require(\"./utils/aggregation\");\n\nvar operatorMap = {\n  'sum': aggregation_1.sum_unsafe,\n  'mean': aggregation_1.mean,\n  'count': aggregation_1.count\n};\n\nfunction copyDataSource(data) {\n  return data.map(function (row) {\n    return __assign({}, row);\n  });\n}\n\nfunction aggregate(props) {\n  var dimensions = props.dimensions,\n      measures = props.measures,\n      asFields = props.asFields,\n      operator = props.operator,\n      dataSource = props.dataSource;\n  var data = [];\n  var cube = createCube({\n    type: 'moment',\n    aggFunc: operatorMap[operator] || aggregation_1.count,\n    dimensions: dimensions,\n    measures: measures,\n    factTable: dataSource\n  });\n  var table = transform_1.tree2Table({\n    dimensions: dimensions,\n    measures: measures,\n    cube: cube\n  });\n  table.forEach(function (row) {\n    asFields.forEach(function (as, i) {\n      row[as] = row[measures[i]];\n    });\n  });\n  return table;\n}\n\nfunction createCube(_a) {\n  var type = _a.type,\n      _b = _a.aggFunc,\n      aggFunc = _b === void 0 ? aggregation_1.count : _b,\n      _c = _a.factTable,\n      factTable = _c === void 0 ? [] : _c,\n      _d = _a.dimensions,\n      dimensions = _d === void 0 ? [] : _d,\n      _e = _a.measures,\n      measures = _e === void 0 ? [] : _e;\n\n  switch (type) {\n    case \"period\":\n      return new index_1.periodCube({\n        aggFunc: aggFunc,\n        factTable: factTable,\n        dimensions: dimensions,\n        measures: measures\n      });\n\n    case \"moment\":\n      return new index_1.momentCube({\n        aggFunc: aggFunc,\n        factTable: factTable,\n        dimensions: dimensions,\n        measures: measures\n      });\n\n    default:\n      return new index_1.momentCube({\n        aggFunc: aggFunc,\n        factTable: factTable,\n        dimensions: dimensions,\n        measures: measures\n      });\n  }\n}\n\nexports.createCube = createCube;\nexports.default = aggregate;\n\n__export(require(\"./utils/aggregation\"));","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.sum_unsafe = function (subset, measures) {\n  var sums = {};\n  measures.forEach(function (mea) {\n    sums[mea] = 0;\n  });\n\n  var _loop_1 = function _loop_1(i, len) {\n    measures.forEach(function (mea) {\n      sums[mea] += subset[i][mea];\n    });\n  };\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    _loop_1(i, len);\n  }\n\n  return sums;\n};\n\nexports.sum = function (subset, measures) {\n  var sums = {};\n  measures.forEach(function (mea) {\n    sums[mea] = 0;\n  });\n\n  var _loop_2 = function _loop_2(i, len) {\n    measures.forEach(function (mea) {\n      sums[mea] += Number(subset[i][mea]) || 0;\n    });\n  };\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    _loop_2(i, len);\n  }\n\n  return sums;\n};\n\nexports.count = function (subset, MEASURES) {\n  var cnts = {};\n  MEASURES.forEach(function (mea) {\n    cnts[mea] = 0;\n  });\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    MEASURES.forEach(function (mea) {\n      cnts[mea]++;\n    });\n  }\n\n  return cnts;\n};\n\nexports.mean = function (subset, measures) {\n  var sums = {};\n  measures.forEach(function (mea) {\n    sums[mea] = 0;\n  });\n\n  var _loop_3 = function _loop_3(i, len) {\n    measures.forEach(function (mea) {\n      sums[mea] += Number(subset[i][mea]) || 0;\n    });\n  };\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    _loop_3(i, len);\n  }\n\n  measures.forEach(function (mea) {\n    sums[mea] /= subset.length;\n  });\n  return sums;\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar periodCube_1 = require(\"./periodCube\");\n\nexports.periodCube = periodCube_1.default;\n\nvar momentCube_1 = require(\"./momentCube\");\n\nexports.momentCube = momentCube_1.default;","\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Node =\n/** @class */\nfunction () {\n  function Node(aggFunc) {\n    this.children = new Map();\n    this._rawData = [];\n    this.aggFunc = aggFunc;\n    this.cache = false;\n  }\n\n  Node.prototype.push = function () {\n    var _a;\n\n    var params = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      params[_i] = arguments[_i];\n    }\n\n    (_a = this._rawData).push.apply(_a, __spread(params));\n  };\n\n  Node.prototype.aggData = function (measures) {\n    if (measures === void 0) {\n      measures = [];\n    }\n\n    if (!this.cache) {\n      this._aggData = this.aggFunc(this.rawData, measures);\n      this.cache = true;\n    }\n\n    return this._aggData;\n  };\n\n  Node.prototype.clearCache = function () {\n    this.cache = false;\n  };\n\n  Object.defineProperty(Node.prototype, \"rawData\", {\n    get: function get() {\n      var e_1, _a;\n\n      if (!this.cache) {\n        if (this.children.size !== 0) {\n          var children = this.children.values();\n          var rawData = [];\n\n          try {\n            for (var children_1 = __values(children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {\n              var child = children_1_1.value;\n              var i = void 0;\n              var data = child.rawData;\n              var len = data.length;\n\n              for (i = 0; i < len; i++) {\n                rawData.push(data[i]);\n              }\n            }\n          } catch (e_1_1) {\n            e_1 = {\n              error: e_1_1\n            };\n          } finally {\n            try {\n              if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n          }\n\n          this._rawData = rawData;\n        }\n\n        this.cache = true;\n      }\n\n      return this._rawData;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Node.prototype.getNode = function (dimensions) {\n    var search = function search(node, level) {\n      var e_2, _a;\n\n      if (level === dimensions.length) {\n        return node;\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_2 = __values(children), children_2_1 = children_2.next(); !children_2_1.done; children_2_1 = children_2.next()) {\n          var _b = __read(children_2_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (children_2_1 && !children_2_1.done && (_a = children_2.return)) _a.call(children_2);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      return null;\n    };\n\n    return search(this, 0);\n  };\n\n  return Node;\n}();\n\nvar periodCube =\n/** @class */\nfunction () {\n  function periodCube(props) {\n    this.aggFunc = props.aggFunc;\n    this.factTable = props.factTable;\n    this.dimensions = props.dimensions;\n    this.measures = props.measures;\n  }\n\n  periodCube.prototype.get = function (dimensions) {\n    var _a = this,\n        tree = _a.tree,\n        aggFunc = _a.aggFunc,\n        measures = _a.measures;\n\n    var search = function search(node, level) {\n      var e_3, _a;\n\n      if (level === dimensions.length) {\n        return node.aggData(measures);\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_3 = __values(children), children_3_1 = children_3.next(); !children_3_1.done; children_3_1 = children_3.next()) {\n          var _b = __read(children_3_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_3_1) {\n        e_3 = {\n          error: e_3_1\n        };\n      } finally {\n        try {\n          if (children_3_1 && !children_3_1.done && (_a = children_3.return)) _a.call(children_3);\n        } finally {\n          if (e_3) throw e_3.error;\n        }\n      }\n\n      return false;\n    };\n\n    return search(tree, 0);\n  };\n\n  periodCube.prototype.getNode = function (dimensions) {\n    var tree = this.tree;\n    return tree.getNode(dimensions);\n  };\n\n  periodCube.prototype.buildTree = function () {\n    var tree = new Node(this.aggFunc);\n    var len = this.factTable.length,\n        i;\n\n    for (i = 0; i < len; i++) {\n      this.insertNode(this.factTable[i], tree, 0);\n    }\n\n    this.tree = tree;\n    return tree;\n  };\n\n  periodCube.prototype.insertNode = function (record, node, level) {\n    node.push(record);\n    node.cache = false;\n\n    if (level < this.dimensions.length) {\n      var member = record[this.dimensions[level]];\n\n      if (!node.children.has(member)) {\n        node.children.set(member, new Node(this.aggFunc));\n      }\n\n      this.insertNode(record, node.children.get(member), level + 1);\n    }\n  };\n\n  periodCube.prototype.aggTree = function (node) {\n    var e_4, _a;\n\n    if (node === void 0) {\n      node = this.tree;\n    }\n\n    var children = node.children.values();\n\n    try {\n      for (var children_4 = __values(children), children_4_1 = children_4.next(); !children_4_1.done; children_4_1 = children_4.next()) {\n        var child = children_4_1.value;\n        this.aggTree(child);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (children_4_1 && !children_4_1.done && (_a = children_4.return)) _a.call(children_4);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    node.aggData(this.measures);\n    return node;\n  };\n\n  periodCube.prototype.aggNode = function (node) {\n    var e_5, _a;\n\n    if (node === void 0) {\n      node = this.tree;\n    }\n\n    var children = node.children.values();\n\n    try {\n      for (var children_5 = __values(children), children_5_1 = children_5.next(); !children_5_1.done; children_5_1 = children_5.next()) {\n        var child = children_5_1.value;\n        this.aggTree(child);\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (children_5_1 && !children_5_1.done && (_a = children_5.return)) _a.call(children_5);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    node.aggData(this.measures);\n    return node;\n  };\n\n  return periodCube;\n}();\n\nexports.default = periodCube;","\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Node =\n/** @class */\nfunction () {\n  function Node() {\n    this.children = new Map();\n    this.rawData = [];\n  }\n\n  Node.prototype.push = function () {\n    var _a;\n\n    var params = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      params[_i] = arguments[_i];\n    }\n\n    (_a = this.rawData).push.apply(_a, __spread(params));\n  };\n\n  Node.prototype.aggData = function (aggFunc, measures) {\n    if (measures === void 0) {\n      measures = [];\n    }\n\n    this._aggData = aggFunc(this.rawData, measures);\n    return this._aggData;\n  };\n\n  Node.prototype.getNode = function (dimensions) {\n    var search = function search(node, level) {\n      var e_1, _a;\n\n      if (level === dimensions.length) {\n        return node;\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_1 = __values(children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {\n          var _b = __read(children_1_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return null;\n    };\n\n    return search(this, 0);\n  };\n\n  return Node;\n}();\n\nexports.Node = Node;\n\nvar momentCube =\n/** @class */\nfunction () {\n  function momentCube(props) {\n    this.aggFunc = props.aggFunc;\n    this.factTable = props.factTable;\n    this.dimensions = props.dimensions;\n    this.measures = props.measures;\n    this.buildTree();\n    this.aggTree();\n  }\n\n  momentCube.prototype.get = function (dimensions) {\n    var _a = this,\n        tree = _a.tree,\n        aggFunc = _a.aggFunc,\n        measures = _a.measures;\n\n    var search = function search(node, level) {\n      var e_2, _a;\n\n      if (level === dimensions.length) {\n        return node.aggData(aggFunc, measures);\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_2 = __values(children), children_2_1 = children_2.next(); !children_2_1.done; children_2_1 = children_2.next()) {\n          var _b = __read(children_2_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (children_2_1 && !children_2_1.done && (_a = children_2.return)) _a.call(children_2);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      return false;\n    };\n\n    return search(tree, 0);\n  };\n\n  momentCube.prototype.getNode = function (dimensions) {\n    var tree = this.tree;\n    return tree.getNode(dimensions);\n  };\n\n  momentCube.prototype.setData = function (props) {\n    var _a = props.aggFunc,\n        aggFunc = _a === void 0 ? this.aggFunc : _a,\n        _b = props.factTable,\n        factTable = _b === void 0 ? this.factTable : _b,\n        _c = props.dimensions,\n        dimensions = _c === void 0 ? this.dimensions : _c,\n        _d = props.measures,\n        measures = _d === void 0 ? this.measures : _d;\n\n    if (dimensions !== this.dimensions || factTable !== this.factTable) {\n      this.dimensions = dimensions;\n      this.factTable = factTable;\n      this.measures = measures;\n      this.aggFunc = aggFunc;\n      this.buildTree();\n      this.aggTree();\n    } else if (measures !== this.measures || aggFunc !== this.aggFunc) {\n      this.measures = measures;\n      this.aggFunc = aggFunc;\n      this.aggTree();\n    }\n  };\n\n  momentCube.prototype.buildTree = function () {\n    var tree = new Node();\n    var len = this.factTable.length,\n        i;\n\n    for (i = 0; i < len; i++) {\n      this.insertNode(this.factTable[i], tree, 0);\n    }\n\n    this.tree = tree;\n    return tree;\n  };\n\n  momentCube.prototype.insertNode = function (record, node, level) {\n    if (level === this.dimensions.length) {\n      node.push(record);\n    } else {\n      var member = record[this.dimensions[level]];\n\n      if (!node.children.has(member)) {\n        node.children.set(member, new Node());\n      }\n\n      this.insertNode(record, node.children.get(member), level + 1);\n    }\n  };\n\n  momentCube.prototype.aggTree = function (node) {\n    var e_3, _a;\n\n    if (node === void 0) {\n      node = this.tree;\n    }\n\n    if (node.children.size > 0) {\n      node.rawData = [];\n      var children = node.children.values();\n\n      try {\n        for (var children_3 = __values(children), children_3_1 = children_3.next(); !children_3_1.done; children_3_1 = children_3.next()) {\n          var child = children_3_1.value;\n          var i = void 0;\n          var data = this.aggTree(child).rawData;\n          var len = data.length;\n\n          for (i = 0; i < len; i++) {\n            node.rawData.push(data[i]);\n          }\n        }\n      } catch (e_3_1) {\n        e_3 = {\n          error: e_3_1\n        };\n      } finally {\n        try {\n          if (children_3_1 && !children_3_1.done && (_a = children_3.return)) _a.call(children_3);\n        } finally {\n          if (e_3) throw e_3.error;\n        }\n      }\n    }\n\n    node.aggData(this.aggFunc, this.measures);\n    return node;\n  };\n\n  return momentCube;\n}();\n\nexports.default = momentCube;","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction tree2Table(props) {\n  var dimensions = props.dimensions,\n      measures = props.measures,\n      cube = props.cube;\n  var aggFunc = cube.aggFunc;\n  var table = [];\n\n  function dfs(node, record, level) {\n    var e_1, _a, _b;\n\n    if (node.children.size === 0) {\n      var values = node._aggData;\n      table.push(__assign(__assign({}, record), values));\n      return;\n    }\n\n    try {\n      for (var _c = __values(node.children.entries()), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var _e = __read(_d.value, 2),\n            childName = _e[0],\n            child = _e[1];\n\n        var r = __assign(__assign({}, record), (_b = {}, _b[dimensions[level]] = childName, _b));\n\n        dfs(child, r, level + 1);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  }\n\n  dfs(cube.tree, {}, 0);\n  return table;\n}\n\nexports.tree2Table = tree2Table;","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}","export default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}","import _defineProperty from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar JOIN_SYMBOL = '_';\nvar MAGIC_NUMBER = 5;\n\nfunction deepcopy(data) {\n  return JSON.parse(JSON.stringify(data));\n}\n\nfunction isFieldCategory(dataSource, fieldName) {\n  return dataSource.every(function (record) {\n    return typeof record[fieldName] === 'string' || typeof record[fieldName] === 'undefined' || record[fieldName] === null;\n  });\n}\n\nfunction isFieldContinous(dataSource, fieldName) {\n  return dataSource.every(function (record) {\n    return typeof record[fieldName] === 'number' || typeof record[fieldName] === 'undefined' || record[fieldName] === null;\n  });\n}\n\nfunction isFieldNumeric(dataSource, fieldName) {\n  return dataSource.every(function (record) {\n    return !isNaN(record[fieldName]) || typeof record[fieldName] === 'undefined' || record[fieldName] === null;\n  });\n}\n\nfunction isFieldTime(dataSource, fieldName) {\n  return dataSource.every(function (record) {\n    return !isNaN(Date.parse(record[fieldName])) && typeof record[fieldName] === 'string' && /^[0-9]{0,4}[-/][0-9]{0,2}([-/][0-9]{0,2}$)?/.test(record[fieldName]) || typeof record[fieldName] === 'undefined' || record[fieldName] === null;\n  });\n}\n\nfunction aggregate(_ref) {\n  var dataSource = _ref.dataSource,\n      fields = _ref.fields,\n      bys = _ref.bys,\n      _ref$method = _ref.method,\n      method = _ref$method === void 0 ? 'sum' : _ref$method;\n  var tmp = [];\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = bys[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var by = _step.value;\n      var map = new Map();\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var record = _step2.value;\n          var key = JSON.stringify(fields.map(function (field) {\n            return record[field];\n          }));\n\n          if (!map.has(key)) {\n            map.set(key, 0);\n          }\n\n          map.set(key, map.get(key) + record[by]);\n        };\n\n        for (var _iterator2 = dataSource[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = map[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var _ref4 = _step3.value;\n\n          var _ref3 = _slicedToArray(_ref4, 2);\n\n          var key = _ref3[0];\n          var value = _ref3[1];\n\n          var row = _defineProperty({\n            index: key\n          }, by, value);\n\n          var dims = JSON.parse(key);\n\n          for (var i = 0; i < fields.length; i++) {\n            row[fields[i]] = dims[i];\n          }\n\n          tmp.push(row);\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  var ans = new Map();\n\n  for (var _i = 0, _tmp = tmp; _i < _tmp.length; _i++) {\n    var record = _tmp[_i];\n\n    if (!ans.has(record.index)) {\n      ans.set(record.index, {});\n    }\n\n    ans.set(record.index, _objectSpread({}, ans.get(record.index), {}, record));\n  }\n\n  return _toConsumableArray(ans.values());\n}\n\nfunction memberCount(dataSource, field) {\n  var counter = new Map();\n  var _iteratorNormalCompletion4 = true;\n  var _didIteratorError4 = false;\n  var _iteratorError4 = undefined;\n\n  try {\n    for (var _iterator4 = dataSource[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n      var row = _step4.value;\n      var member = row[field];\n\n      if (!counter.has(member)) {\n        counter.set(member, 0);\n      }\n\n      counter.set(member, counter.get(member) + 1);\n    }\n  } catch (err) {\n    _didIteratorError4 = true;\n    _iteratorError4 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n        _iterator4.return();\n      }\n    } finally {\n      if (_didIteratorError4) {\n        throw _iteratorError4;\n      }\n    }\n  }\n\n  return _toConsumableArray(counter.entries());\n}\n\nfunction groupContinousField(_ref5) {\n  var dataSource = _ref5.dataSource,\n      field = _ref5.field,\n      _ref5$newField = _ref5.newField,\n      newField = _ref5$newField === void 0 ? \"\".concat(field, \"(con-group)\") : _ref5$newField,\n      groupNumber = _ref5.groupNumber;\n  // const members = memberCount(dataSource, field);\n  // todo: outlier detection\n  var values = dataSource.map(function (item) {\n    return item[field];\n  });\n  var max = Math.max.apply(Math, _toConsumableArray(values)); // Number.EPSILON * ;\n\n  var min = Math.min.apply(Math, _toConsumableArray(values));\n  var segWidth = (max - min) / groupNumber;\n  var ranges = [];\n\n  for (var i = 0; i < groupNumber; i++) {\n    var left = min + i * segWidth;\n    var right = min + (i + 1) * segWidth;\n    ranges.push([left, right]);\n  }\n\n  ranges[0][0] = -Infinity;\n  ranges[ranges.length - 1][1] = Infinity;\n  var precision = Math.max(1, Math.log10(Math.abs(min)) - Math.log10(segWidth)) + 1;\n\n  var _loop2 = function _loop2(_i2) {\n    var record = dataSource[_i2];\n    var rangeIndex = ranges.findIndex(function (r) {\n      return r[0] <= record[field] && record[field] < r[1];\n    });\n    var range = ranges[rangeIndex];\n\n    if (typeof range !== 'undefined') {\n      record[newField] = \"\".concat(rangeIndex + 1, \":[\").concat(Number(range[0].toPrecision(precision)), \", \").concat(Number(range[1].toPrecision(precision)), \")\");\n    } else {\n      record[newField] = 'null';\n    }\n  };\n\n  for (var _i2 = 0; _i2 < dataSource.length; _i2++) {\n    _loop2(_i2);\n  }\n\n  return dataSource;\n}\n\nfunction groupCategoryField(_ref6) {\n  var dataSource = _ref6.dataSource,\n      field = _ref6.field,\n      _ref6$newField = _ref6.newField,\n      newField = _ref6$newField === void 0 ? \"\".concat(field, \"(cat-group)\") : _ref6$newField,\n      groupNumber = _ref6.groupNumber;\n  // auto category should obey Power law distrubution.\n  var members = memberCount(dataSource, field);\n  members.sort(function (a, b) {\n    return b[1] - a[1];\n  });\n  var sum = members.map(function (v) {\n    return v[1];\n  });\n  groupNumber = members.length;\n\n  for (var i = sum.length - 2; i >= 0; i--) {\n    sum[i] = sum[i + 1] + sum[i];\n  }\n\n  for (var _i3 = 0; _i3 < members.length - 2; _i3++) {\n    // strict mode\n    // if (members[i][1] >= sum[i + 1] && members[i + 1][1] < sum[i + 2]) {\n    if (members[_i3][1] * MAGIC_NUMBER >= sum[_i3 + 1] && members[_i3 + 1][1] / MAGIC_NUMBER < sum[_i3 + 2]) {\n      groupNumber = _i3 + 2;\n      break;\n    }\n  } // groupNumber = Math.max(Math.round(Math.sqrt(members.length)), groupNumber)\n\n\n  if (groupNumber === members.length) {\n    return dataSource.map(function (record) {\n      return _objectSpread({}, record, _defineProperty({}, newField, record[field]));\n    });\n  }\n\n  var set = new Set();\n\n  for (var _i4 = groupNumber - 1; _i4 < members.length; _i4++) {\n    set.add(members[_i4][0]);\n  }\n\n  var _iteratorNormalCompletion5 = true;\n  var _didIteratorError5 = false;\n  var _iteratorError5 = undefined;\n\n  try {\n    for (var _iterator5 = dataSource[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n      var record = _step5.value;\n\n      if (set.has(record[field])) {\n        record[newField] = 'others';\n      } else {\n        record[newField] = record[field];\n      }\n    }\n  } catch (err) {\n    _didIteratorError5 = true;\n    _iteratorError5 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n        _iterator5.return();\n      }\n    } finally {\n      if (_didIteratorError5) {\n        throw _iteratorError5;\n      }\n    }\n  }\n\n  return dataSource;\n}\n/**\n * KullbackLeibler divergence\n * @param p1List\n * @param p2List\n *\n */\n\n\nfunction DKL(p1List, p2List) {\n  var sum = 0;\n  var len = Math.max(p1List.length, p2List.length);\n\n  for (var i = 0; i < len; i++) {\n    var p1 = p1List[i] || 0;\n    var p2 = p2List[i] || 0;\n    sum += p1 * Math.log2(p1 / p2);\n  }\n\n  return sum;\n}\n\nexport { deepcopy, memberCount, groupCategoryField, groupContinousField, aggregate, isFieldCategory, isFieldContinous, isFieldTime, isFieldNumeric, JOIN_SYMBOL, DKL };","import { memberCount } from './utils';\n\nfunction isUniformDistribution(dataSource, field) {\n  var members = memberCount(dataSource, field);\n  return members.every(function (member) {\n    return member[1] === 1;\n  });\n}\n\nexport { isUniformDistribution };","function normalize(frequencyList) {\n  var sum = 0;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = frequencyList[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var f = _step.value;\n      sum += f;\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return frequencyList.map(function (f) {\n    return f / sum;\n  });\n}\n\nvar entropy = function entropy(probabilityList) {\n  var sum = 0;\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = probabilityList[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var p = _step2.value;\n      sum += p * Math.log2(p);\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  return -sum;\n};\n\nvar gini = function gini(probabilityList) {\n  var sum = 0;\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = probabilityList[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var p = _step3.value;\n      sum += p * (1 - p);\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return sum;\n};\n\nexport { normalize, entropy, gini };","import { isFieldTime, isFieldContinous, memberCount, isFieldCategory, deepcopy, groupContinousField, groupCategoryField } from '../utils';\nimport { normalize, entropy } from '../impurityMeasure';\nimport { isUniformDistribution } from '../distribution';\nvar MIN_QUAN_MEMBER_SIZE = 25;\n/**\n *\n * @param dataSource\n * @param field\n * todo: should accept BIField type and calculate the semantic type basic on it.\n */\n\nexport function getFieldType(dataSource, field) {\n  if (isFieldTime(dataSource, field)) {\n    return 'temporal';\n  } else if (isFieldContinous(dataSource, field)) {\n    // Todo:\n    // here is only a tmp solution. we still hope to divided ordinal type and quantitative type.\n    // if (memberCount(dataSource, field).length > MIN_QUAN_MEMBER_SIZE) {\n    //   return 'quantitative'\n    // } else {\n    //   return 'ordinal';\n    // }\n    return 'quantitative';\n  } else if (isFieldCategory(dataSource, field)) {\n    // isFieldCategory is a safety checking here, for sometimes dirty data value can be object.\n    return 'nominal';\n  } else {\n    // todo do something(like cleaning)\n    return 'nominal';\n  }\n}\nexport function getAllFieldTypes(dataSource, fields) {\n  var fieldsWithType = [];\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = fields[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var field = _step.value;\n      fieldsWithType.push({\n        name: field,\n        type: getFieldType(dataSource, field)\n      });\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return fieldsWithType;\n}\nexport function getFieldDistribution(dataSource, field) {\n  var members = memberCount(dataSource, field); // members.sort((a, b) => a[1] - b[1]);\n\n  return members.map(function (m) {\n    return {\n      memberName: m[0],\n      count: m[1]\n    };\n  });\n}\nexport function getAllFieldsDistribution(dataSource, fields) {\n  var fieldsDistribution = [];\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = fields[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var field = _step2.value;\n      fieldsDistribution.push({\n        fieldName: field,\n        distribution: getFieldDistribution(dataSource, field)\n      });\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  return fieldsDistribution;\n}\nexport function getFieldEntropy(dataSource, field) {\n  var members = memberCount(dataSource, field);\n  var frequencyList = members.map(function (m) {\n    return m[1];\n  });\n  var probabilityList = normalize(frequencyList);\n  var fieldEntropy = entropy(probabilityList);\n  var maxEntropy = Math.log2(members.length);\n  return {\n    fieldName: field,\n    entropy: fieldEntropy,\n    maxEntropy: maxEntropy\n  };\n}\nexport function getAllFieldsEntropy(dataSource, fields) {\n  var fieldEntropyList = [];\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = fields[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var field = _step3.value;\n      fieldEntropyList.push(getFieldEntropy(dataSource, field));\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return fieldEntropyList;\n}\nexport function groupFields(dataSource, fields) {\n  var groupedData = deepcopy(dataSource);\n  var newFields = [];\n  var _iteratorNormalCompletion4 = true;\n  var _didIteratorError4 = false;\n  var _iteratorError4 = undefined;\n\n  try {\n    for (var _iterator4 = fields[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n      var field = _step4.value;\n      var newFieldName = \"\".concat(field.name, \"(group)\");\n\n      if (field.type === 'quantitative' && memberCount(dataSource, field.name).length > MIN_QUAN_MEMBER_SIZE * 2) {\n        if (!isUniformDistribution(dataSource, field.name)) {\n          groupedData = groupContinousField({\n            dataSource: groupedData,\n            field: field.name,\n            newField: newFieldName,\n            groupNumber: 8\n          });\n          newFields.push({\n            name: newFieldName,\n            type: 'ordinal'\n          });\n        }\n      } else if ((field.type === 'ordinal' || field.type === 'nominal') && memberCount(dataSource, field.name).length > MIN_QUAN_MEMBER_SIZE) {\n        if (!isUniformDistribution(dataSource, field.name)) {\n          groupedData = groupCategoryField({\n            dataSource: groupedData,\n            field: field.name,\n            newField: newFieldName,\n            groupNumber: 8\n          });\n          newFields.push({\n            name: newFieldName,\n            type: field.type\n          });\n        }\n      }\n    }\n  } catch (err) {\n    _didIteratorError4 = true;\n    _iteratorError4 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n        _iterator4.return();\n      }\n    } finally {\n      if (_didIteratorError4) {\n        throw _iteratorError4;\n      }\n    }\n  }\n\n  return {\n    groupedData: groupedData,\n    fields: fields,\n    newFields: newFields\n  };\n}","/* eslint no-restricted-globals: 0 */\nimport { UnivariateSummary } from 'visual-insights';\nconst { getAllFieldsDistribution, getAllFieldTypes, getAllFieldsEntropy } = UnivariateSummary;\n\n\nconst fieldSummary = (e) => {\n  const { fields, dataSource } = e.data;\n  let fieldNames = []\n  for (let i = 0; i < fields.length; i++) {\n    if (typeof fields[i] === 'string') {\n      fieldNames.push(fields[i])\n    } else {\n      fieldNames.push(fields[i].name)\n    }\n  }\n  try {\n    // todo:\n    // should field type changed after re-group ?\n    // pros: it generates a new fields. we should regard the new fields as a independent one without care about the original one's property.\n    // cons: there might be a difference between nominal and ordinal field for data mining. some quantitative field become a ordinal one instead of nominal one. how to judge this case?\n    // quantitative -> ordinal ? if quantitative, vis can use linear color scale or opacity, else use norminal color scale which lost info (can be fixed for ordinal in future)\n    const fieldDistributionList = getAllFieldsDistribution(dataSource, fieldNames);\n    const fieldTypeList = getAllFieldTypes(dataSource, fieldNames).map((f, i) => {\n      return { ...f, type: typeof fields[i] === 'string' ? f.type : fields[i].type }\n    });\n    // const fieldTypeList = getAllFieldTypes(dataSource, fieldNames);\n    const fieldEntropyList = getAllFieldsEntropy(dataSource, fieldNames);\n    self.postMessage({\n      success: true,\n      data: fieldDistributionList.map((field, index) => {\n        return {\n          ...field,\n          ...fieldEntropyList[index],\n          type: fieldTypeList[index].type\n        }\n      })\n    })\n  } catch (error) {\n    self.postMessage({\n      success: false,\n      message: error.toString()\n    })\n  }\n}\n\nself.addEventListener('message', fieldSummary, false)"],"sourceRoot":""}